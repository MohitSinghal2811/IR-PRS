{% extends 'rail/base.html' %}
{% load static %}
{% load widget_tweaks %}


{% block body %}


<div class="w3-display-left" style="width:80vw ;margin-left:12vw; opacity:0.9; ">
    <div class="w3-container w3-white w3-padding-16"  style="height: 100%; border: solid black; border-radius: 20px;">
        <form method="post">
            {% csrf_token %}
            <div class = "row">
                <div class = "col-lg-2">
                    <p><b>Train Number</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>Train Name</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b> Starts </b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b> Ends </b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b> Departure Date </b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b> Departure Time </b></p>
                </div>
            </div>
            <div class = "row">
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.train.trainNumber }}</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.train.name }}</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.train.starts }}</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.train.ends }}</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.departureDate }}</b></p>
                </div>
                <div class = "col-lg-2">
                    <p><b>{{ releasedTrain.departureTime }}</b></p>
                </div>
            </div>
            <div class = "row">
                <div class = "col-lg-1">
                </div>
                <div class = "col-lg-10">
                    <h1 class="h3 mb-3 font-weight-normal w3-center">Please fill in the details of the Passengers</h1>
                </div>
                <div class = "col-lg-1">
                </div>
            </div>
            <div class = "row">
                <div class = "col-lg-6">
                    <h3>Sleeper Seats available:-</h3>{{slavailable}}
                </div>
                <div class = "col-lg-6">
                    <h3>AC Seats available:-</h3>{{acavailable}}
                </div>
            </div>
            <div class = "row">
                {{ ticket_form.coachType.label_tag }}
                {% render_field ticket_form.coachType class=" w3-center " %}
            </div>
            <div class = "row">
                {% if ticket_form.coachType.errors %}
                    {% for error in ticket_form.coachType.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            </div>

            </br>
            {{ errorMessage }}
            </br>

            

            {{ passenger_formset.management_form }}

            {% for passenger_form in passenger_formset %}
                <div class="passenger-formset col-">
                    {{ passenger_form.aadhar }}
                    {% if passenger_form.aadhar.errors %}
                        {% for error in passenger_form.aadhar.errors %}
                            {{ error|escape }}
                        {% endfor %}
                    {% endif %}
                    
                    
                    {{ passenger_form.name }}
                    {% if passenger_form.name.errors %}
                        {% for error in passenger_form.name.errors %}
                            {{ error|escape }}
                        {% endfor %}
                    {% endif %}

                    {{ passenger_form.age }}
                    {% if passenger_form.age.errors %}
                        {% for error in passenger_form.age.errors %}
                            {{ error|escape }}
                        {% endfor %}
                    {% endif %}

                    {{ passenger_form.gender }}
                    {% if passenger_form.gender.errors %}
                        {% for error in passenger_form.gender.errors %}
                            {{ error|escape }}
                        {% endfor %}
                    {% endif %}



                </div>
            {% endfor %}

            {% if passenger_formset.non_form_errors %}
                {% for error in passenger_formset.non_form_errors %}
                    {{ error|escape }}
                {% endfor %}
            {% endif %}

            <input type="submit" value="Book Ticket" class="button"/>
        </form>

    </div>
</div>


{% comment %} {% if messages %}
    {% for message in messages %}
        <p>{{ message }}</p>
    {% endfor %}
{% endif %}  {% endcomment %}








{% endblock %}


{% block end-scripts %}
<!-- Include formset plugin - including jQuery dependency -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.formset/1.2.2/jquery.formset.js"></script>
<script>
    $('.passenger-formset').formset({
        addText: '<b>Add passenger</b>',
        deleteText: '<b>Remove</b>'
    });
</script>
{% endblock %}